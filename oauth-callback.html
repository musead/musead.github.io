<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>OAuth Callback - MUSEA.D</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f7f7f7;color:#222;margin:0;padding:28px}
    .box{max-width:900px;margin:0 auto;background:#fff;padding:20px;border-radius:8px}
    h1{margin-top:0;font-size:1.4rem}
    pre{background:#f1f1f1;padding:12px;border-radius:6px;overflow:auto}
    .note{color:#666;margin-top:12px}
    .btn{display:inline-block;padding:8px 12px;background:#0a66c2;color:#fff;border-radius:6px;text-decoration:none}
  </style>
</head>
<body>
  <div class="box">
    <h1>OAuth Callback</h1>
    <p>이 페이지는 Pinterest OAuth에서 리디렉션된 후 authorization <strong>code</strong>를 수신해 표시합니다. 아래 정보는 데모/테스트 확인용입니다.</p>

    <h2>수신된 쿼리 파라미터</h2>
    <pre id="params">로딩 중...</pre>

    <div class="note">
      <p><strong>중요:</strong> 클라이언트 시크릿은 절대 이 페이지(프런트엔드)에 노출하지 마세요. 실제로는 서버에서 authorization code를 받아서 client_id+client_secret으로 토큰 교환을 수행해야 합니다.</p>
      <p>서버가 없다면, 테스트용으로 여기에서 code 값을 복사해 서버 측에서 교환하세요.</p>
    </div>

    <h2>간단 테스트 버튼</h2>
    <p><a id="copyBtn" class="btn" href="#">code 복사</a></p>

    <script>
      function parseQuery() {
        const qs = location.search.replace(/^\?/,'');
        if(!qs) return {};
        return Object.fromEntries(new URLSearchParams(qs));
      }
      const params = parseQuery();
      const pre = document.getElementById('params');
      if(Object.keys(params).length===0){
        pre.textContent = '쿼리 파라미터가 없습니다. Pinterest 인증 후 리디렉션되어야 합니다.';
      } else {
        pre.textContent = JSON.stringify(params, null, 2);
      }
      const copyBtn = document.getElementById('copyBtn');
      copyBtn.addEventListener('click', (e)=>{
        e.preventDefault();
        const code = params.code || '';
        if(!code){ alert('code 파라미터가 없습니다. 인증 흐름을 다시 확인하세요.'); return; }
        navigator.clipboard.writeText(code).then(()=> alert('code가 클립보드에 복사되었습니다.'));
      });
    </script>
  </div>
</body>
</html>
